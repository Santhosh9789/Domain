<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OmniShop | Wireless Headphones</title>
  <link href="../../../assets/img/favicon.png" rel="icon" type="image/png">
  <link href="../../../assets/img/apple-touch-icon.png" rel="apple-touch-icon">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <style>
        /* Modern Cart Modal */
        .cart-modal {
            position: fixed; top: 0; right: -400px; width: 350px; height: 100vh;
            background: white; box-shadow: -5px 0 30px rgba(0,0,0,0.1);
            transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 1000;
            display: flex; flex-direction: column;
            will-change: transform;
            backface-visibility: hidden;
        }
        .cart-modal.open { transform: translateX(-400px); right: -400px; } /* Use transform instead of right */
        .cart-header { padding: 20px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; font-weight: 700; font-size: 1.2rem; }
        .close-cart { cursor: pointer; color: #888; transition: 0.2s; }
        .close-cart:hover { color: #000; }
        
        .cart-items { flex: 1; overflow-y: auto; padding: 20px; }
        .cart-item { display: flex; gap: 15px; margin-bottom: 20px; animation: slideIn 0.3s ease; }
        .cart-item img { width: 60px; height: 60px; object-fit: cover; border-radius: 8px; }
        .item-info { flex: 1; }
        .item-title { font-size: 0.9rem; font-weight: 600; margin-bottom: 5px; }
        .item-price { color: #888; font-size: 0.85rem; }
        .remove-item { color: #ff6b6b; font-size: 0.8rem; cursor: pointer; margin-top: 5px; display: inline-block; }

        .cart-footer { padding: 20px; border-top: 1px solid #eee; background: #f9f9f9; }
        .total-row { display: flex; justify-content: space-between; font-weight: 700; margin-bottom: 20px; font-size: 1.1rem; }
        .btn-checkout { width: 100%; background: #111; color: white; border: none; padding: 15px; border-radius: 10px; font-weight: 600; cursor: pointer; transition: 0.2s; }
        .btn-checkout:hover { opacity: 0.9; transform: translateY(-2px); }

        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.3); z-index: 900; opacity: 0; pointer-events: none; transition: 0.3s; }
        .overlay.active { opacity: 1; pointer-events: initial; }

        @keyframes slideIn { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } }
    </style>
</head>
<body>

    <nav>
        <div class="logo">OmniShop.</div>
        <div class="nav-icons">
            <i class="fas fa-search"></i>
            <div class="cart-icon" onclick="toggleCart()">
                <i class="fas fa-shopping-bag"></i>
                <span class="cart-count">0</span>
            </div>
        </div>
    </nav>

    <div class="overlay" onclick="toggleCart()"></div>

    <!-- Cart Sidebar -->
    <div class="cart-modal" id="cartModal">
        <div class="cart-header">
            <span>Your Cart</span>
            <i class="fas fa-times close-cart" onclick="toggleCart()"></i>
        </div>
        <div class="cart-items" id="cartItems">
            <div style="text-align:center; margin-top:50px; color:#888;">Your cart is empty</div>
        </div>
        <div class="cart-footer">
            <div class="total-row">
                <span>Total</span>
                <span id="cartTotal">$0.00</span>
            </div>
            <button class="btn-checkout" onclick="alert('Proceeding to Checkout Demo...')">Checkout</button>
        </div>
    </div>

    <main class="product-container">
        <!-- Gallery -->
        <div class="product-gallery">
            <div class="main-image">
                <img src="https://images.unsplash.com/photo-1505740420928-5e560c06d30e?ixlib=rb-1.2.1" id="currentInfo" loading="lazy" decoding="async">
            </div>
            <div class="thumbnails">
                <img src="https://images.unsplash.com/photo-1505740420928-5e560c06d30e?ixlib=rb-1.2.1" class="active" onclick="changeImage(this)" loading="lazy" decoding="async">
                <img src="https://images.unsplash.com/photo-1583394838336-acd977736f90?ixlib=rb-1.2.1" onclick="changeImage(this)" loading="lazy" decoding="async">
                <img src="https://images.unsplash.com/photo-1484704849700-f032a568e944?ixlib=rb-1.2.1" onclick="changeImage(this)" loading="lazy" decoding="async">
            </div>
        </div>

        <!-- Details -->
        <div class="product-details">
            <div class="breadcrumb">Home / Audio / Wireless Series</div>
            <h1>Sony WH-1000XM4 Wireless Noise Cancelling</h1>
            <div class="price">$348.00</div>
            
            <div class="options">
                <div class="colors">
                    <span>Color: BLACK</span>
                    <div class="color-select selected" style="background:#000;" onclick="selectColor(this, 'Black')"></div>
                    <div class="color-select" style="background:#c0c0c0;" onclick="selectColor(this, 'Silver')"></div>
                    <div class="color-select" style="background:#1a1a2e;" onclick="selectColor(this, 'Midnight Blue')"></div>
                </div>
            </div>

            <div class="actions">
                <div class="quantity">
                    <button onclick="decrement()">-</button>
                    <input type="text" id="qty" value="1" readonly>
                    <button onclick="increment()">+</button>
                </div>
                <button class="add-to-cart" onclick="addToCart()">Add to Cart - $348.00</button>
            </div>
        </div>
    </main>

    <div id="toast-container" style="position:fixed; bottom:20px; right:20px; display:flex; flex-direction:column; gap:10px; z-index:2000;"></div>

    <script>
        // Advanced: Persistence
        let cart = JSON.parse(localStorage.getItem('omniCart')) || [];
        let selectedColor = 'Black';
        const basePrice = 348.00;

        // Init Load
        renderCart();

        function saveCart() {
            localStorage.setItem('omniCart', JSON.stringify(cart));
            renderCart();
        }

        // Image Swap
        function changeImage(thumb) {
            document.querySelector('.main-image img').src = thumb.src;
            document.querySelectorAll('.thumbnails img').forEach(img => img.classList.remove('active'));
            thumb.classList.add('active');
        }

        // Color Selection
        function selectColor(el, color) {
            document.querySelectorAll('.color-select').forEach(c => c.classList.remove('selected'));
            el.classList.add('selected');
            selectedColor = color;
            document.querySelector('.colors span').innerText = `Color: ${color.toUpperCase()}`;
        }

        // Qty Logic
        const qtyInput = document.getElementById('qty');
        function increment() { 
            qtyInput.value = parseInt(qtyInput.value) + 1; 
            updateBtnPrice();
        }
        function decrement() { 
            if(parseInt(qtyInput.value) > 1) { 
                qtyInput.value = parseInt(qtyInput.value) - 1; 
                updateBtnPrice();
            } 
        }

        function updateBtnPrice() {
            const total = (basePrice * parseInt(qtyInput.value)).toFixed(2);
            document.querySelector('.add-to-cart').innerText = `Add to Cart - $${total}`;
        }

        // Cart Logic
        function toggleCart() {
            document.getElementById('cartModal').classList.toggle('open');
            document.querySelector('.overlay').classList.toggle('active');
        }

        function addToCart() {
            const qty = parseInt(qtyInput.value);
            const item = {
                title: 'Sony WH-1000XM4',
                color: selectedColor,
                price: basePrice,
                qty: qty,
                img: document.querySelector('.main-image img').src
            };

            cart.push(item);
            saveCart();
            
            showToast(`Added ${qty} x ${selectedColor} to Cart`);
            
            toggleCart(); 
            
            // Reset
            qtyInput.value = 1;
            updateBtnPrice();
        }

        function renderCart() {
            const container = document.getElementById('cartItems');
            const countBadge = document.querySelector('.cart-count');
            
            if(cart.length === 0) {
                container.innerHTML = '<div style="text-align:center; margin-top:50px; color:#888;">Your cart is empty</div>';
                countBadge.innerText = 0;
                document.getElementById('cartTotal').innerText = '$0.00';
                return;
            }

            container.innerHTML = '';
            let total = 0;
            let count = 0;

            cart.forEach((item, index) => {
                total += item.price * item.qty;
                count += item.qty;
                container.innerHTML += `
                    <div class="cart-item">
                        <img src="${item.img}" loading="lazy" decoding="async">
                        <div class="item-info">
                            <div class="item-title">${item.title}</div>
                            <div class="item-price">${item.color} | Qty: ${item.qty}</div>
                            <div class="item-price">$${(item.price * item.qty).toFixed(2)}</div>
                            <span class="remove-item" onclick="removeItem(${index})">Remove</span>
                        </div>
                    </div>
                `;
            });

            countBadge.innerText = count;
            document.getElementById('cartTotal').innerText = '$' + total.toFixed(2);
        }

        function removeItem(index) {
            cart.splice(index, 1);
            saveCart();
        }

        // Advanced: Toast Notification
        function showToast(msg) {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.style.cssText = `
                background: #333; color: white; padding: 12px 20px; border-radius: 8px; 
                box-shadow: 0 5px 15px rgba(0,0,0,0.2); animation: slideInRight 0.3s; font-size: 0.9rem; display: flex; align-items: center; gap: 10px;
            `;
            toast.innerHTML = `<i class="fas fa-check-circle" style="color:#4CAF50;"></i> ${msg}`;
            
            container.appendChild(toast);
            
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateY(10px)';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Add Keyframes for toast
        const style = document.createElement('style');
        style.innerHTML = `@keyframes slideInRight { from { transform: translateX(100%); opacity:0; } to { transform: translateX(0); opacity:1; } }`;
        document.head.appendChild(style);

    </script>
<script src="https://unpkg.com/lenis@1.0.45/dist/lenis.min.js"></script>

<script>
    // Smooth scrolling for demos
    const lenis = new Lenis({
      duration: 1.2,
      easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
      direction: 'vertical',
      gestureDirection: 'vertical',
      smooth: true,
      mouseMultiplier: 0.8,
      smoothTouch: false,
      touchMultiplier: 2,
    });

    function raf(time) {
      lenis.raf(time);
      requestAnimationFrame(raf);
    }

    requestAnimationFrame(raf);
</script>

</body>
</html>